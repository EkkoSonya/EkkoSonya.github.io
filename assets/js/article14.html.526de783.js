"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[4921],{83671:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}},64762:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>d,data:()=>r});var t=a(7847);const e=a.p+"assets/img/56.70b1ae2b.png",p=a.p+"assets/img/57.e1ef8409.png",o=a.p+"assets/img/58.117d1add.png",i=a.p+"assets/img/59.8bea758a.png",c=[(0,t.Fv)('<h2 id="内容" tabindex="-1"><a class="header-anchor" href="#内容"><span>内容</span></a></h2><ul><li>导入地址簿功能代码</li><li>用户下单</li><li>订单支付</li></ul><h2 id="导入地址簿功能代码" tabindex="-1"><a class="header-anchor" href="#导入地址簿功能代码"><span>导入地址簿功能代码</span></a></h2><h3 id="需求分析" tabindex="-1"><a class="header-anchor" href="#需求分析"><span>需求分析</span></a></h3><h4 id="产品原型" tabindex="-1"><a class="header-anchor" href="#产品原型"><span>产品原型</span></a></h4><p>地址簿，指的是消费者用户的地址信息，用户登录成功后可以维护自己的地址信息。同一个用户可以有多个地址信息，但是只能有一个<strong>默认地址</strong></p><figure><img src="'+e+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><p>对于地址簿管理，我们需要实现以下几个功能：</p><ul><li>查询地址列表</li><li>新增地址</li><li>修改地址</li><li>删除地址</li><li>设置默认地址</li><li>查询默认地址</li></ul><h4 id="接口设计" tabindex="-1"><a class="header-anchor" href="#接口设计"><span>接口设计</span></a></h4><p>根据上述原型图先<strong>粗粒度</strong>设计接口，共包含7个接口</p><p><strong>接口设计：</strong></p><ul><li>新增地址</li><li>查询登录用户所有地址</li><li>查询默认地址</li><li>根据id修改地址</li><li>根据id删除地址</li><li>根据id查询地址</li><li>设置默认地址</li></ul><p>接下来<strong>细粒度</strong>分析每个接口，明确每个接口的请求方式、请求路径、传入参数和返回值</p><p>1). 新增地址 <code>POST /user/addressBook</code></p><p>2). 查询登录用户所有地址 <code>GET /user/addressBook/list</code></p><p>3). 查询默认地址 <code>GET /user/addressBook/default</code></p><p>4). 修改地址 <code>PUT /user/addressBook</code></p><p>5). 根据id删除地址 <code>DELETE /user/addressBook/{id}</code></p><p>6). 根据id查询地址 <code>GET /user/addressBook/{id}</code></p><p>7). 设置默认地址 <code>PUT /user/addressBook/default</code></p><h4 id="数据表设计-address-book" tabindex="-1"><a class="header-anchor" href="#数据表设计-address-book"><span>数据表设计 <code>address_book</code></span></a></h4><p>用户的地址信息会存储在address_book表，即地址簿表中。具体表结构如下：</p><table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td>自增</td></tr><tr><td>user_id</td><td>bigint</td><td>用户id</td><td>逻辑外键</td></tr><tr><td>consignee</td><td>varchar(50)</td><td>收货人</td><td></td></tr><tr><td>sex</td><td>varchar(2)</td><td>性别</td><td></td></tr><tr><td>phone</td><td>varchar(11)</td><td>手机号</td><td></td></tr><tr><td>province_code</td><td>varchar(12)</td><td>省份编码</td><td></td></tr><tr><td>province_name</td><td>varchar(32)</td><td>省份名称</td><td></td></tr><tr><td>city_code</td><td>varchar(12)</td><td>城市编码</td><td></td></tr><tr><td>city_name</td><td>varchar(32)</td><td>城市名称</td><td></td></tr><tr><td>district_code</td><td>varchar(12)</td><td>区县编码</td><td></td></tr><tr><td>district_name</td><td>varchar(32)</td><td>区县名称</td><td></td></tr><tr><td>detail</td><td>varchar(200)</td><td>详细地址信息</td><td>具体到门牌号</td></tr><tr><td>label</td><td>varchar(100)</td><td>标签</td><td>公司、家、学校</td></tr><tr><td>is_default</td><td>tinyint(1)</td><td>是否默认地址</td><td>1是 0否</td></tr></tbody></table><p>这里面有一个字段is_default，实际上我们在设置默认地址时，只需要更新这个字段就可以了</p><h4 id="代码导入" tabindex="-1"><a class="header-anchor" href="#代码导入"><span>代码导入</span></a></h4><p>对于这一类的单表的增删改查，我们已经写过很多了，基本的开发思路都是一样的，那么本小节的用户地址簿管理的增删改查功能，我们就不再一一实现了，基本的代码我们都已经提供了，直接导入进来，做一个测试即可</p><h2 id="用户下单" tabindex="-1"><a class="header-anchor" href="#用户下单"><span>用户下单</span></a></h2><h3 id="需求分析-1" tabindex="-1"><a class="header-anchor" href="#需求分析-1"><span>需求分析</span></a></h3><h4 id="产品原型-1" tabindex="-1"><a class="header-anchor" href="#产品原型-1"><span>产品原型</span></a></h4><p><strong>用户下单业务说明</strong></p><p>在电商系统中，用户是通过下单的方式通知商家，用户已经购买了商品，需要商家进行备货和发货</p><p>用户下单后会产生订单相关数据，订单数据需要能够体现如下信息</p><p>用户将菜品或者套餐加入购物车后，可以点击购物车中的 &quot;去结算&quot; 按钮，页面跳转到订单确认页面，点击 &quot;去支付&quot; 按钮则完成下单操作</p><p><strong>用户点餐业务流程(效果图)</strong></p><figure><img src="'+p+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><h4 id="接口分析-设计-post-user-order-submit" tabindex="-1"><a class="header-anchor" href="#接口分析-设计-post-user-order-submit"><span>接口分析 设计 <code>POST /user/order/submit</code></span></a></h4><figure><img src="'+o+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><figure><img src="'+i+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><h4 id="表设计" tabindex="-1"><a class="header-anchor" href="#表设计"><span>表设计</span></a></h4><p>用户下单业务对应的数据表为<code>orders</code>表和<code>order_detail</code>表(一对多关系,一个订单关联多个订单明细)：</p><table><thead><tr><th>表名</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>orders</td><td>订单表</td><td>主要存储订单的基本信息(如: 订单号、状态、金额、支付方式、下单用户、收件地址等)</td></tr><tr><td>order_detail</td><td>订单明细表</td><td>主要存储订单详情信息(如: 该订单关联的套餐及菜品的信息)</td></tr></tbody></table><p>具体的表结构如下:</p><p><strong>1). orders订单表</strong></p><table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td>自增</td></tr><tr><td>number</td><td>varchar(50)</td><td>订单号</td><td></td></tr><tr><td>status</td><td>int</td><td>订单状态</td><td>1待付款 2待接单 3已接单 4派送中 5已完成 6已取消</td></tr><tr><td>user_id</td><td>bigint</td><td>用户id</td><td>逻辑外键</td></tr><tr><td>address_book_id</td><td>bigint</td><td>地址id</td><td>逻辑外键</td></tr><tr><td>order_time</td><td>datetime</td><td>下单时间</td><td></td></tr><tr><td>checkout_time</td><td>datetime</td><td>付款时间</td><td></td></tr><tr><td>pay_method</td><td>int</td><td>支付方式</td><td>1微信支付 2支付宝支付</td></tr><tr><td>pay_status</td><td>tinyint</td><td>支付状态</td><td>0未支付 1已支付 2退款</td></tr><tr><td>amount</td><td>decimal(10,2)</td><td>订单金额</td><td></td></tr><tr><td>remark</td><td>varchar(100)</td><td>备注信息</td><td></td></tr><tr><td>phone</td><td>varchar(11)</td><td>手机号</td><td>冗余字段</td></tr><tr><td>address</td><td>varchar(255)</td><td>详细地址信息</td><td>冗余字段</td></tr><tr><td>consignee</td><td>varchar(32)</td><td>收货人</td><td>冗余字段</td></tr><tr><td>cancel_reason</td><td>varchar(255)</td><td>订单取消原因</td><td></td></tr><tr><td>rejection_reason</td><td>varchar(255)</td><td>拒单原因</td><td></td></tr><tr><td>cancel_time</td><td>datetime</td><td>订单取消时间</td><td></td></tr><tr><td>estimated_delivery_time</td><td>datetime</td><td>预计送达时间</td><td></td></tr><tr><td>delivery_status</td><td>tinyint</td><td>配送状态</td><td>1立即送出 0选择具体时间</td></tr><tr><td>delivery_time</td><td>datetime</td><td>送达时间</td><td></td></tr><tr><td>pack_amount</td><td>int</td><td>打包费</td><td></td></tr><tr><td>tableware_number</td><td>int</td><td>餐具数量</td><td></td></tr><tr><td>tableware_status</td><td>tinyint</td><td>餐具数量状态</td><td>1按餐量提供 0选择具体数量</td></tr></tbody></table><p><strong>2). order_detail订单明细表</strong></p><table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td>自增</td></tr><tr><td>name</td><td>varchar(32)</td><td>商品名称</td><td>冗余字段</td></tr><tr><td>image</td><td>varchar(255)</td><td>商品图片路径</td><td>冗余字段</td></tr><tr><td>order_id</td><td>bigint</td><td>订单id</td><td>逻辑外键</td></tr><tr><td>dish_id</td><td>bigint</td><td>菜品id</td><td>逻辑外键</td></tr><tr><td>setmeal_id</td><td>bigint</td><td>套餐id</td><td>逻辑外键</td></tr><tr><td>dish_flavor</td><td>varchar(50)</td><td>菜品口味</td><td></td></tr><tr><td>number</td><td>int</td><td>商品数量</td><td></td></tr><tr><td>amount</td><td>decimal(10,2)</td><td>商品单价</td><td></td></tr></tbody></table><p><strong>说明</strong>: 用户提交订单时，需要往订单表<code>orders</code>中插入一条记录，并且需要往<code>order_detail</code>中插入一条或多条记录</p><h3 id="代码开发" tabindex="-1"><a class="header-anchor" href="#代码开发"><span>代码开发</span></a></h3><h4 id="dto设计-orderssubmitdto" tabindex="-1"><a class="header-anchor" href="#dto设计-orderssubmitdto"><span>DTO设计 <code>OrdersSubmitDTO</code></span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrdersSubmitDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>\n    <span class="token comment">//地址簿id</span>\n    <span class="token keyword">private</span> <span class="token class-name">Long</span> addressBookId<span class="token punctuation">;</span>\n    <span class="token comment">//付款方式</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> payMethod<span class="token punctuation">;</span>\n    <span class="token comment">//备注</span>\n    <span class="token keyword">private</span> <span class="token class-name">String</span> remark<span class="token punctuation">;</span>\n    <span class="token comment">//预计送达时间</span>\n    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>shape <span class="token operator">=</span> <span class="token class-name">JsonFormat<span class="token punctuation">.</span>Shape</span><span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> estimatedDeliveryTime<span class="token punctuation">;</span>\n    <span class="token comment">//配送状态  1立即送出  0选择具体时间</span>\n    <span class="token keyword">private</span> <span class="token class-name">Integer</span> deliveryStatus<span class="token punctuation">;</span>\n    <span class="token comment">//餐具数量</span>\n    <span class="token keyword">private</span> <span class="token class-name">Integer</span> tablewareNumber<span class="token punctuation">;</span>\n    <span class="token comment">//餐具数量状态  1按餐量提供  0选择具体数量</span>\n    <span class="token keyword">private</span> <span class="token class-name">Integer</span> tablewareStatus<span class="token punctuation">;</span>\n    <span class="token comment">//打包费</span>\n    <span class="token keyword">private</span> <span class="token class-name">Integer</span> packAmount<span class="token punctuation">;</span>\n    <span class="token comment">//总金额</span>\n    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> amount<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="vo设计" tabindex="-1"><a class="header-anchor" href="#vo设计"><span>VO设计</span></a></h4><p>根据用户下单接口的返回结果设计VO</p><p>在sky-pojo模块，OrderSubmitVO.java已定义</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>\n<span class="token annotation punctuation">@Builder</span>\n<span class="token annotation punctuation">@NoArgsConstructor</span>\n<span class="token annotation punctuation">@AllArgsConstructor</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderSubmitVO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>\n    <span class="token comment">//订单id</span>\n    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>\n    <span class="token comment">//订单号</span>\n    <span class="token keyword">private</span> <span class="token class-name">String</span> orderNumber<span class="token punctuation">;</span>\n    <span class="token comment">//订单金额</span>\n    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> orderAmount<span class="token punctuation">;</span>\n    <span class="token comment">//下单时间</span>\n    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> orderTime<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="controller层-ordercontroller-submit" tabindex="-1"><a class="header-anchor" href="#controller层-ordercontroller-submit"><span>Controller层 <code>OrderController.submit()</code></span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token doc-comment comment">/**\n * 订单\n */</span>\n<span class="token annotation punctuation">@RestController</span><span class="token punctuation">(</span><span class="token string">&quot;userOrderController&quot;</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user/order&quot;</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@Slf4j</span>\n<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token string">&quot;C端-订单接口&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>\n    <span class="token doc-comment comment">/**\n     * 用户下单\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">ordersSubmitDTO</span>\n     * <span class="token keyword">@return</span>\n     */</span>\n    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/submit&quot;</span><span class="token punctuation">)</span>\n    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;用户下单&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderSubmitVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">OrdersSubmitDTO</span> ordersSubmitDTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;用户下单：{}&quot;</span><span class="token punctuation">,</span> ordersSubmitDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">OrderSubmitVO</span> orderSubmitVO <span class="token operator">=</span> orderService<span class="token punctuation">.</span><span class="token function">submitOrder</span><span class="token punctuation">(</span>ordersSubmitDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>orderSubmitVO<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> \n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="service层接口-orderservice-submitorder" tabindex="-1"><a class="header-anchor" href="#service层接口-orderservice-submitorder"><span>Service层接口 <code>OrderService.submitOrder()</code></span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>\n<span class="token doc-comment comment">/**\n * 用户下单\n * <span class="token keyword">@param</span> <span class="token parameter">ordersSubmitDTO</span>\n * <span class="token keyword">@return</span>\n */</span>\n<span class="token class-name">OrderSubmitVO</span> <span class="token function">submitOrder</span><span class="token punctuation">(</span><span class="token class-name">OrdersSubmitDTO</span> ordersSubmitDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="service层实现类-orderserviceimpl" tabindex="-1"><a class="header-anchor" href="#service层实现类-orderserviceimpl"><span>Service层实现类 <code>OrderServiceImpl</code></span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token doc-comment comment">/**\n * 订单\n */</span>\n<span class="token annotation punctuation">@Service</span>\n<span class="token annotation punctuation">@Slf4j</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token keyword">private</span> <span class="token class-name">OrderMapper</span> orderMapper<span class="token punctuation">;</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token keyword">private</span> <span class="token class-name">OrderDetailMapper</span> orderDetailMapper<span class="token punctuation">;</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token keyword">private</span> <span class="token class-name">ShoppingCartMapper</span> shoppingCartMapper<span class="token punctuation">;</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token keyword">private</span> <span class="token class-name">AddressBookMapper</span> addressBookMapper<span class="token punctuation">;</span>\n\n\n    <span class="token doc-comment comment">/**\n     * 用户下单\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">ordersSubmitDTO</span>\n     * <span class="token keyword">@return</span>\n     */</span>\n    <span class="token annotation punctuation">@Transactional</span>\n    <span class="token keyword">public</span> <span class="token class-name">OrderSubmitVO</span> <span class="token function">submitOrder</span><span class="token punctuation">(</span><span class="token class-name">OrdersSubmitDTO</span> ordersSubmitDTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//异常情况的处理（收货地址为空、超出配送范围、购物车为空）</span>\n        <span class="token class-name">AddressBook</span> addressBook <span class="token operator">=</span> addressBookMapper<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>ordersSubmitDTO<span class="token punctuation">.</span><span class="token function">getAddressBookId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>addressBook <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AddressBookBusinessException</span><span class="token punctuation">(</span><span class="token class-name">MessageConstant</span><span class="token punctuation">.</span><span class="token constant">ADDRESS_BOOK_IS_NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token class-name">Long</span> userId <span class="token operator">=</span> <span class="token class-name">BaseContext</span><span class="token punctuation">.</span><span class="token function">getCurrentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">ShoppingCart</span> shoppingCart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShoppingCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        shoppingCart<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//查询当前用户的购物车数据</span>\n        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ShoppingCart</span><span class="token punctuation">&gt;</span></span> shoppingCartList <span class="token operator">=</span> shoppingCartMapper<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>shoppingCart<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>shoppingCartList <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> shoppingCartList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ShoppingCartBusinessException</span><span class="token punctuation">(</span><span class="token class-name">MessageConstant</span><span class="token punctuation">.</span><span class="token constant">SHOPPING_CART_IS_NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token comment">//构造订单数据</span>\n        <span class="token class-name">Orders</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Orders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>ordersSubmitDTO<span class="token punctuation">,</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span>addressBook<span class="token punctuation">.</span><span class="token function">getPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span>addressBook<span class="token punctuation">.</span><span class="token function">getDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setConsignee</span><span class="token punctuation">(</span>addressBook<span class="token punctuation">.</span><span class="token function">getConsignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">Orders</span><span class="token punctuation">.</span><span class="token constant">PENDING_PAYMENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setPayStatus</span><span class="token punctuation">(</span><span class="token class-name">Orders</span><span class="token punctuation">.</span><span class="token constant">UN_PAID</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        order<span class="token punctuation">.</span><span class="token function">setOrderTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//向订单表插入1条数据</span>\n        orderMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//订单明细数据</span>\n        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderDetail</span><span class="token punctuation">&gt;</span></span> orderDetailList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> cart <span class="token operator">:</span> shoppingCartList<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token class-name">OrderDetail</span> orderDetail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>cart<span class="token punctuation">,</span> orderDetail<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderDetail<span class="token punctuation">.</span><span class="token function">setOrderId</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderDetailList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>orderDetail<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token comment">//向明细表插入n条数据</span>\n        orderDetailMapper<span class="token punctuation">.</span><span class="token function">insertBatch</span><span class="token punctuation">(</span>orderDetailList<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//清理购物车中的数据</span>\n        shoppingCartMapper<span class="token punctuation">.</span><span class="token function">deleteByUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//封装返回结果</span>\n        <span class="token class-name">OrderSubmitVO</span> orderSubmitVO <span class="token operator">=</span> <span class="token class-name">OrderSubmitVO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">orderNumber</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">orderAmount</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">orderTime</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getOrderTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">return</span> orderSubmitVO<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mapper层-ordermapper-orderdetailmapper" tabindex="-1"><a class="header-anchor" href="#mapper层-ordermapper-orderdetailmapper"><span>Mapper层 <code>OrderMapper | OrderDetailMapper</code></span></a></h4><h5 id="创建ordermapper接口和对应的xml映射文件" tabindex="-1"><a class="header-anchor" href="#创建ordermapper接口和对应的xml映射文件"><span>创建OrderMapper接口和对应的xml映射文件</span></a></h5><p><code>OrderMapper.java</code></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>\n<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderMapper</span> <span class="token punctuation">{</span>\n    <span class="token doc-comment comment">/**\n     * 插入订单数据\n     * <span class="token keyword">@param</span> <span class="token parameter">order</span>\n     */</span>\n    <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Orders</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>OrderMapper.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>\n<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> <span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.sky.mapper.OrderMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>insert<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Orders<span class="token punctuation">&quot;</span></span> <span class="token attr-name">useGeneratedKeys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n        insert into orders\n        (number, status, user_id, address_book_id, order_time, checkout_time, pay_method, pay_status, amount, remark,\n         phone, address, consignee, estimated_delivery_time, delivery_status, pack_amount, tableware_number,\n         tableware_status)\n        values (#{number}, #{status}, #{userId}, #{addressBookId}, #{orderTime}, #{checkoutTime}, #{payMethod},\n                #{payStatus}, #{amount}, #{remark}, #{phone}, #{address}, #{consignee},\n                #{estimatedDeliveryTime}, #{deliveryStatus}, #{packAmount}, #{tablewareNumber}, #{tablewareStatus})\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="创建orderdetailmapper接口和对应的xml映射文件" tabindex="-1"><a class="header-anchor" href="#创建orderdetailmapper接口和对应的xml映射文件"><span>创建OrderDetailMapper接口和对应的xml映射文件</span></a></h4><p><code>OrderDetailMapper.java</code></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>\n<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderDetailMapper</span> <span class="token punctuation">{</span>\n    <span class="token doc-comment comment">/**\n     * 批量插入订单明细数据\n     * <span class="token keyword">@param</span> <span class="token parameter">orderDetails</span>\n     */</span>\n    <span class="token keyword">void</span> <span class="token function">insertBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderDetail</span><span class="token punctuation">&gt;</span></span> orderDetails<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>OrderDetailMapper.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>\n<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> <span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.sky.mapper.OrderDetailMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>insertBatch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n        insert into order_detail\n        (name, order_id, dish_id, setmeal_id, dish_flavor, number, amount, image)\n        values\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>orderDetails<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>od<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n            (#{od.name},#{od.orderId},#{od.dishId},#{od.setmealId},#{od.dishFlavor},\n             #{od.number},#{od.amount},#{od.image})\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',72)],l={},d=(0,a(83671).A)(l,[["render",function(n,s){return(0,t.uX)(),(0,t.CE)("div",null,c)}]]),r=JSON.parse('{"path":"/code/java_item/1-%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96/article14.html","title":"Javassm - item1-14 (用户下单 + 订单支付 1)","lang":"zh-CN","frontmatter":{"title":"Javassm - item1-14 (用户下单 + 订单支付 1)","date":"2025-11-18T00:00:00.000Z","category":["code"],"tag":["java_item"],"order":-0.6,"description":"内容 导入地址簿功能代码 用户下单 订单支付 导入地址簿功能代码 需求分析 产品原型 地址簿，指的是消费者用户的地址信息，用户登录成功后可以维护自己的地址信息。同一个用户可以有多个地址信息，但是只能有一个默认地址 alt textalt text 对于地址簿管理，我们需要实现以下几个功能： 查询地址列表 新增地址 修改地址 删除地址 设置默认地址 查询...","head":[["meta",{"property":"og:url","content":"http://ekkosonya.cn/code/java_item/1-%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96/article14.html"}],["meta",{"property":"og:site_name","content":"EkkoSonya\'s Blog"}],["meta",{"property":"og:title","content":"Javassm - item1-14 (用户下单 + 订单支付 1)"}],["meta",{"property":"og:description","content":"内容 导入地址簿功能代码 用户下单 订单支付 导入地址簿功能代码 需求分析 产品原型 地址簿，指的是消费者用户的地址信息，用户登录成功后可以维护自己的地址信息。同一个用户可以有多个地址信息，但是只能有一个默认地址 alt textalt text 对于地址簿管理，我们需要实现以下几个功能： 查询地址列表 新增地址 修改地址 删除地址 设置默认地址 查询..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-22T04:05:15.000Z"}],["meta",{"property":"article:author","content":"EkkoSonya"}],["meta",{"property":"article:tag","content":"java_item"}],["meta",{"property":"article:published_time","content":"2025-11-18T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-22T04:05:15.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Javassm - item1-14 (用户下单 + 订单支付 1)\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-11-18T00:00:00.000Z\\",\\"dateModified\\":\\"2025-11-22T04:05:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"EkkoSonya\\",\\"url\\":\\"http://ekkosonya.cn\\"}]}"]]},"headers":[{"level":2,"title":"内容","slug":"内容","link":"#内容","children":[]},{"level":2,"title":"导入地址簿功能代码","slug":"导入地址簿功能代码","link":"#导入地址簿功能代码","children":[{"level":3,"title":"需求分析","slug":"需求分析","link":"#需求分析","children":[{"level":4,"title":"产品原型","slug":"产品原型","link":"#产品原型","children":[]},{"level":4,"title":"接口设计","slug":"接口设计","link":"#接口设计","children":[]},{"level":4,"title":"数据表设计 address_book","slug":"数据表设计-address-book","link":"#数据表设计-address-book","children":[]},{"level":4,"title":"代码导入","slug":"代码导入","link":"#代码导入","children":[]}]}]},{"level":2,"title":"用户下单","slug":"用户下单","link":"#用户下单","children":[{"level":3,"title":"需求分析","slug":"需求分析-1","link":"#需求分析-1","children":[{"level":4,"title":"产品原型","slug":"产品原型-1","link":"#产品原型-1","children":[]},{"level":4,"title":"接口分析 设计 POST /user/order/submit","slug":"接口分析-设计-post-user-order-submit","link":"#接口分析-设计-post-user-order-submit","children":[]},{"level":4,"title":"表设计","slug":"表设计","link":"#表设计","children":[]}]},{"level":3,"title":"代码开发","slug":"代码开发","link":"#代码开发","children":[{"level":4,"title":"DTO设计 OrdersSubmitDTO","slug":"dto设计-orderssubmitdto","link":"#dto设计-orderssubmitdto","children":[]},{"level":4,"title":"VO设计","slug":"vo设计","link":"#vo设计","children":[]},{"level":4,"title":"Controller层 OrderController.submit()","slug":"controller层-ordercontroller-submit","link":"#controller层-ordercontroller-submit","children":[]},{"level":4,"title":"Service层接口 OrderService.submitOrder()","slug":"service层接口-orderservice-submitorder","link":"#service层接口-orderservice-submitorder","children":[]},{"level":4,"title":"Service层实现类 OrderServiceImpl","slug":"service层实现类-orderserviceimpl","link":"#service层实现类-orderserviceimpl","children":[]},{"level":4,"title":"Mapper层 OrderMapper | OrderDetailMapper","slug":"mapper层-ordermapper-orderdetailmapper","link":"#mapper层-ordermapper-orderdetailmapper","children":[{"level":5,"title":"创建OrderMapper接口和对应的xml映射文件","slug":"创建ordermapper接口和对应的xml映射文件","link":"#创建ordermapper接口和对应的xml映射文件","children":[]}]},{"level":4,"title":"创建OrderDetailMapper接口和对应的xml映射文件","slug":"创建orderdetailmapper接口和对应的xml映射文件","link":"#创建orderdetailmapper接口和对应的xml映射文件","children":[]}]}]}],"git":{"createdTime":1763784315000,"updatedTime":1763784315000,"contributors":[{"name":"EkkoSonya","email":"ekkosonya@163.com","commits":1}]},"readingTime":{"minutes":6.82,"words":2046},"filePathRelative":"code/java_item/1-苍穹外卖/article14.md","localizedDate":"2025年11月18日","excerpt":"<h2>内容</h2>\\n<ul>\\n<li>导入地址簿功能代码</li>\\n<li>用户下单</li>\\n<li>订单支付</li>\\n</ul>\\n<h2>导入地址簿功能代码</h2>\\n<h3>需求分析</h3>\\n<h4>产品原型</h4>\\n<p>地址簿，指的是消费者用户的地址信息，用户登录成功后可以维护自己的地址信息。同一个用户可以有多个地址信息，但是只能有一个<strong>默认地址</strong></p>\\n<figure><figcaption>alt text</figcaption></figure>\\n<p>对于地址簿管理，我们需要实现以下几个功能：</p>\\n<ul>\\n<li>查询地址列表</li>\\n<li>新增地址</li>\\n<li>修改地址</li>\\n<li>删除地址</li>\\n<li>设置默认地址</li>\\n<li>查询默认地址</li>\\n</ul>","autoDesc":true}')}}]);